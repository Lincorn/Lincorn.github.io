## Ubuntu 安装 RTX 4090 NVIDIA 显卡驱动

作为一名开发者/运维人员，在 Ubuntu 系统中为 RTX 4090 配置合适的 NVIDIA 驱动是跑深度学习、3D 渲染等任务的基础。本文整理了最稳定、易操作的安装流程，所有代码块均可直接复制粘贴，包含前期准备、官方源自动安装（推荐）、官网手动安装三种场景，新手也能轻松上手。

适用场景：Ubuntu 20.04/22.04 等主流版本 | RTX 4090 显卡 | x86_64 系统架构

⚠️ 注意事项：安装前务必禁用 nouveau 开源驱动，避免冲突！所有代码可直接复制粘贴执行。

### 一、前期准备

nouveau 是 Linux 自带的 NVIDIA 开源驱动，会与官方闭源驱动冲突，必须先禁用；同时需确认显卡和系统信息，确保驱动适配。

#### 1. 禁用 nouveau 开源驱动

步骤1：创建禁用配置文件

执行以下命令编辑配置文件（若不习惯 vim，可替换为 nano，操作逻辑一致）：
```bash
sudo vim /etc/modprobe.d/blacklist-nouveau.conf
```
步骤2：写入禁用规则

在文件中粘贴以下内容，保存并退出（vim 按 ESC → 输入 :wq 回车）：
```bash
blacklist nouveau
options nouveau modeset=0
```
无图形化可用这个禁用规则
```bash
blacklist nouveau
blacklist lbm-nouveau
options nouveau modeset=0
alias nouveau off
alias lbm-nouveau off
```
步骤3：更新配置并重启

执行更新命令使配置生效，随后重启系统：
```bash
sudo update-initramfs -u
sudo reboot
```
步骤4：验证禁用结果

重启后执行以下命令，无任何输出即表示禁用成功：
```bash
lsmod | grep nouveau
```
#### 2. 确认显卡与系统信息

检查 RTX 4090 识别状态

执行命令查看显卡是否被系统识别（能看到 NVIDIA 设备信息即正常）：
```bash
lspci | grep -i nvidia
```
确认系统架构

RTX 4090 驱动仅适配 64 位系统，执行命令验证：
```bash
uname -m
```
正常输出：x86_64

### 二、方法一：官方源自动安装（推荐）

通过 NVIDIA 官方 PPA 源安装，系统会自动匹配最优驱动版本，无需手动选版本，稳定性最高，代码可直接批量复制执行。

#### 1. 添加 NVIDIA 官方 PPA 源

依次复制粘贴以下命令，更新软件源并添加显卡驱动专属 PPA：
```bash
sudo apt update
sudo apt install -y software-properties-common
sudo add-apt-repository ppa:graphics-drivers/ppa
sudo apt update
```
#### 2. 查看推荐驱动版本

执行命令后，找到标注 recommended 的版本（即为适配 RTX 4090 的最佳版本）：
```bash
ubuntu-drivers devices
```
#### 3. 自动安装推荐驱动

一键安装系统推荐的驱动，无需手动指定版本：
```bash
sudo ubuntu-drivers autoinstall
```
#### 4. 验证安装结果

重启系统后，执行核心验证命令，显示 GPU 信息 + 驱动版本即安装成功：
```bash
sudo reboot
# 重启后执行以下命令
nvidia-smi
```
成功标志：nvidia-smi 输出中能看到 RTX 4090 型号、驱动版本（如 550.xx）、GPU 状态等信息。

### 三、方法二：NVIDIA 官网手动安装

若官方源安装失败（如版本不匹配），可通过官网下载驱动文件手动安装，灵活性更高，所有代码可直接复制粘贴。

#### 1. 下载对应驱动文件

打开 [NVIDIA 官网驱动下载页](https://www.nvidia.com/Download/index.aspx)，按以下参数精准选择：

- 产品类型：GeForce

- 产品系列：RTX 40 Series

- 产品型号：RTX 4090

- 操作系统：Linux 64-bit

- 下载类型：生产分支（推荐）

下载后缀为 .run 的驱动文件（示例：NVIDIA-Linux-x86_64-550.xx.run，xx 为具体版本号）。

#### 2. 安装依赖环境

手动安装需要编译驱动，先安装必备的编译工具：
```bash
sudo apt update
sudo apt install -y build-essential gcc make linux-headers-$(uname -r)
```
#### 3. 关闭图形界面（关键步骤）

图形界面会干扰驱动安装，需切换到文本模式：
```bash
# 关闭 gdm3 服务（Ubuntu 默认桌面环境）
sudo systemctl stop gdm3
```
按 Ctrl+Alt+F3 切换到文本终端，输入账号密码登录。

#### 4. 执行驱动安装

步骤1：进入驱动下载目录（示例：Downloads 文件夹）
```bash
cd ~/Downloads
```
步骤2：赋予驱动文件执行权限

将文件名替换为实际下载的 .run 文件名称：
```bash
chmod +x NVIDIA-Linux-x86_64-550.xx.run
```
步骤3：运行安装程序

同样替换为实际下载的文件名：
```bash
sudo ./NVIDIA-Linux-x86_64-550.xx.run
```
步骤4：安装过程交互选项（按提示选择）

1. 同意 NVIDIA 软件许可协议；

2. 如需运行 32 位程序，选择 “Install NVIDIA 32-bit compatibility libraries”；

3. 提示 “自动配置 Xorg” 时，选择 “Yes”；

4. 其余选项默认即可。

5. 验证安装结果

安装完成后重启系统，执行验证命令：
```bash
sudo reboot
# 重启后执行
nvidia-smi
```
### 四、常见问题解决

- 安装后 nvidia-smi 报错：检查 nouveau 是否彻底禁用，重启后重新执行验证命令；

- 手动安装提示 “缺少内核头文件”：补装内核头文件，命令如下：
```bash
sudo apt install linux-headers-generic
```
- 重启后无法进入桌面：切换到文本模式（Ctrl+Alt+F3），重新运行驱动安装程序，选择 “Overwrite existing configuration” 覆盖配置。

总结

1. 优先选官方源自动安装：操作简单、适配性强，90% 以上场景都适用，代码可直接复制批量执行；

2. 禁用 nouveau 是前提：未禁用会直接导致驱动安装失败，务必验证禁用结果；

3. 验证核心命令：无论哪种安装方式，最终通过 nvidia-smi 检查驱动是否生效。

